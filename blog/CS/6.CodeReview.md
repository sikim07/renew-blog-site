---
title: '코드 리뷰 / Code Review'
date: 2022-08-30 22:46:02
category: 'CS'
draft: false
---

## Code Review
---

![image](code_scan.png)

### 코드리뷰의 목적
1. 기능의 정상 동작 여부
2. 버그의 조기 발견
3. 개발 표준(Convention) 준수 여부
4. 코드리뷰를 통한 조직 역량 강화 *(개인 성향 및 격차 해소)*
5. 중복코드를 방지하고 모듈의 재사용성 증대
6. 가독성과 유지보수 편의성
7. 테스트 코드의 작성 여부
8. 배울 점은 없는지
9. 책임자를 추궁하지 않는 문화 정착

---
### 방법들
1. **온라인 코드리뷰**
도구를 이용하여 온라인상에서 진행하는 방식의 코드리뷰.
일반적으로 한 명의 코드를 리뷰하는 사람은 적게는 1명에서 많게는 5명 이상까지 진행.
코드 수정이 필요하다면 코드 작성자(Committer)는 수정 사항들을 반영하고, 이 과정이 
완료되면 Reviewer들은 코드의 최종 확인을 완료.
2. **오프라인 팀 리뷰**
팀 구성원들이 주기적으로 오프라인에서 진행하는 리뷰.
예를 들어, 온라인 코드리뷰 과정에서 나왔던 내용을 기반으로 자유로운 토론을 진행할 수도 
있고, 좋은 사례를 전체적으로 공유하는 시간으로 진행.
자신이 궁금했던 점을 질문하거나 온라인 코드리뷰 과정에서 개선되었으면 하는 점을 제안.

### 순서
1. **이슈 작성: Committer**
Gitea Issue/Milestone 생성
Slack : 실시간 질의 응답
Issue : 히스토리가 필요한 기술문서
PR Comment : 코드 수정 관련으로 한정
2. **Pull Request(PR)**
ex: feature/AAA
커밋명: 동사 + 명사 + #이슈번호
ex: Change requests to aiohttp #1
3. **코드 리뷰 #1: Reviewer**
1일 이내 피드백을 해야하고 이를 넘길 시 미리 양해를 구해야 한다.
PR Open 후 3일 이내 종료를 목표로 수행하고 여의치 않으면 대무자 요청
4. **코드리뷰 #2: Committer**
2점을 획득하여야 merge가 가능
약한 approve : 1점
강한 approve : 2점
기본적으로 사람 1명의 approve는 1점, 상황의 긴급하거나 확신있는 approve는 
1명이 2점 부여
5. **코드리뷰 #2: Reviewer**
Approve : 코드에 문제가 없어 승인한다.
Comment : 수정을 요구할 정도는 아닌 코멘트
Request change : 코드가 승인되기 위해서 수정이 필요
6. **3~5 반복 / Merge 및 종료**
Approve 될 때까지 리뷰 절차 반복.
Approve 되면 Resolve 처리 후 Merge를 진행하거나, 개발 진행 중이라면 PR을 
종료하고 다음 개발 프로세스 진행.

---
### 코드리뷰의 방향성
- **코드의 맥락(CONTEXT)을 이해할 수 있는 설명을 추가하라**
코드를 작성하는 사람은 코드리뷰를 받기 전에 해당 코드가 어떤 목적을 가지고 작성되었으며
왜 필요한지에 대한 맥락을 리뷰어가 이해할 수 있도록 설명을 적어두는 것이 좋습니다. 설명을
소스코드의 주석으로 다는 경우도 있지만, 대부분의 버전 관리 시스템은 소스코드 변경의 이력을
쉽게 추적할 수 있기 때문에 주석보다는 코드리뷰 도구의 메시지 또는 코멘트를 이용하는 것이 
좋습니다.
  
- **하나의 이슈(버그, 기능추가)당 하나의 코드리뷰**
리뷰어는 독립된 하나의 이슈에 집중할 수 없고, 리뷰의 진행이 산만해지게 됩니다. 
코드를 작성할 때에는 가급적 하나의 이슈에 대해서 하나의 코드리뷰가 수행될 수 있도록 
하는 것이 좋습니다.
  
- **리뷰 받는 코드는 한 번에 500줄 이하**
   한 번에 확인해야 하는 코드의 양이 너무 많은 경우 리뷰어는 상세한 리뷰를 진행하기 위해서 한 번에 너무 많은 시간을 투자해야만 합니다. 한 번에 확인해야 하는 코드의 양이 많아지게 되면 발견되는 버그나 개선사항의 밀집도가 낮아져서 결과적으로 많은 부분을 놓치고 지나가게 됩니다.
  
- **주관적인 의견을 표현하는 방식**
   개발 표준(convention)을 준수함으로써 어느 정도 일관된 스타일을 유지할 수는 있지만, 각자가 가진 스타일을 완전히 배제하는 것은 현실적으로 어렵습니다.이때 중요한 것은 표현의 방식에 주의를 기울이는 것입니다. 기존에 자신이 일하던 방식이 정답이라는 생각을 버리고, “나의 의견은 이러한데 당신은 어떻게 생각하시나요?”와 같이 의견을 묻는 것이 좋습니다. 만약, 서로 다른 견해로 좀 더 많은 사람의 의견을 듣고 싶다면 비공식적인 팀 리뷰에 해당 내용을 제안하여 의견을 나눠보는 것도 도움이 됩니다.
  
- **리뷰를 너무 미루지 말자**
   한창 일이 바쁠 때 코드리뷰를 해야 하는 상황이 생기면 누구나 코드리뷰를 잠시 뒤로 미루게 됩니다. 그러나 이렇게 뒤로 미루는 것이 길어지게 되면 코드 작성자는 이어지는 작업에 불편함을 겪게 될 수도 있고, 시간이 지남에 따라 다른 코드와 충돌을 처리하면서 리뷰를 반복해야 하는 경우도 생길 수 있습니다. 이러한 문제를 해결하려면 코드리뷰를 중심 업무의 부수적인 작업으로 인식하지 말고, 코드리뷰에 집중할 수 있는 시간을 전체 일정에서 확보하는 것이 좋습니다.
---
### 기타 관련 용어

- **D-n 룰** : 리뷰를 요청하는 시점에 PR 이 Merge 되어야 하는 일정을 공유하여 리뷰어가 Working day 안에서 
스스로 우선순위를 결정할 수 있도록 함.
  - **D-0 (ASAP)** : 긴급한 수정사항으로 바로 리뷰해 주세요. 앱의 오류로 인해 장애가 발생하거나, 빌드가. 되지 않는 등 긴급 이슈가 발생할 때 사용
  - **D-N (Within N days)** : “Working Day 기준으로 N일 이내에 리뷰해 주세요”
    일반적으로 D-2 태그를 많이 사용하며, 중요도가 낮거나 일정이 여유 있는 경우 D-3 ~ D-5 사용
  
- **WIP(Work In Progress)** : 아직 commit이 완전히 작성되지 않았지만 이 내용을 공유하고 싶을 경우, 
PR을 통해 코드리뷰가 끝난 후 Merge가 진행되지 않도록 PR Title에 명시
  
- **개발 표준(Convention)** : 프로그램의 각 측면에 대한 프로그래밍 스타일, 관행 및 방법을 권장 하는 특정 
프로그래밍 언어에 대한 일련의 지침. 
일반적으로 파일 구성, 들여쓰기, 주석, 선언, 명령문, 공백, 명명 규칙, 프로그래밍 관행, 프로그래밍 원칙, 프로그래밍
경험 법칙, 아키텍처 모범 사례 등을 다룸.
가독성을 높이고 소프트웨어 유지 관리 용이
  
- **Pn 룰** :
코드 리뷰의 코멘트에 Pn 룰을 사용하여 리뷰어가 코멘트를 강조하고 싶은 정도를 표현
  - **P1**: 꼭 반영해주세요 *(Request changes)*
  - **P2**: 적극적으로 고려해주세요 *(Request changes)*
  - **P3**: 웬만하면 반영해 주세요 *(Comment)*
  - **P4**: 반영해도 좋고 넘어가도 좋습니다 *(Approve)*
  - **P5**: 그냥 사소한 의견입니다 *(Approve)*


#### My Comment
코드리뷰는 이직 후 처음으로 업무 공유의 자리에서 발표한 기술 공유 주제이다. 이전 직장에서는 시도 할 수 없던 것이기 때문
에 경험하고 싶었지만 다른 회사들도 이를 시도할 여유가 많진 않은것같았다. 서로의 코드는 커녕 무슨 일을 하는지조차 공유가 어려웠다(
서로 관심조차 <span style="color: grey">~~없다~~</span>없었다). 현재 진행하고 있는 프로젝트가 끝나면 내가 먼저 리뷰를 요청
하는 방식으로 프로세스의 변화를 주려는 노력을 해봐야겠다.